CREATE TABLE [dbo].[Accounts] (
    [ID] [int] NOT NULL IDENTITY,
    [PersonalNumber] [nvarchar](12) NOT NULL,
    [Balance] [float] NOT NULL,
    [Currency_ID] [int] NOT NULL,
    [User_ID] [int] NOT NULL,
    CONSTRAINT [PK_dbo.Accounts] PRIMARY KEY ([ID])
)
CREATE UNIQUE INDEX [IX_PersonalNumber] ON [dbo].[Accounts]([PersonalNumber])
CREATE INDEX [IX_Currency_ID] ON [dbo].[Accounts]([Currency_ID])
CREATE INDEX [IX_User_ID] ON [dbo].[Accounts]([User_ID])
CREATE TABLE [dbo].[Currencies] (
    [ID] [int] NOT NULL IDENTITY,
    [ShortName] [nvarchar](3) NOT NULL,
    [FullName] [nvarchar](25) NOT NULL,
    CONSTRAINT [PK_dbo.Currencies] PRIMARY KEY ([ID])
)
CREATE UNIQUE INDEX [IX_ShortName] ON [dbo].[Currencies]([ShortName])
CREATE UNIQUE INDEX [IX_FullName] ON [dbo].[Currencies]([FullName])
CREATE TABLE [dbo].[Transactions] (
    [ID] [int] NOT NULL IDENTITY,
    [TransactionType] [int] NOT NULL,
    [TransactionDate] [datetime] NOT NULL,
    [Summa] [float] NOT NULL,
    [Comment] [nvarchar](1000),
    [CurrencyForDate_ID] [int] NOT NULL,
    [FromUserAccount_ID] [int] NOT NULL,
    [ToUserAccount_ID] [int],
    [Account_ID] [int],
    CONSTRAINT [PK_dbo.Transactions] PRIMARY KEY ([ID])
)
CREATE INDEX [IX_CurrencyForDate_ID] ON [dbo].[Transactions]([CurrencyForDate_ID])
CREATE INDEX [IX_FromUserAccount_ID] ON [dbo].[Transactions]([FromUserAccount_ID])
CREATE INDEX [IX_ToUserAccount_ID] ON [dbo].[Transactions]([ToUserAccount_ID])
CREATE INDEX [IX_Account_ID] ON [dbo].[Transactions]([Account_ID])
CREATE TABLE [dbo].[CurrencyForDates] (
    [ID] [int] NOT NULL IDENTITY,
    [DateTime] [datetime] NOT NULL,
    [Multiplier] [float] NOT NULL,
    [Currency_ID] [int] NOT NULL,
    CONSTRAINT [PK_dbo.CurrencyForDates] PRIMARY KEY ([ID])
)
CREATE INDEX [IX_Currency_ID] ON [dbo].[CurrencyForDates]([Currency_ID])
CREATE TABLE [dbo].[Users] (
    [ID] [int] NOT NULL IDENTITY,
    [IsAdmin] [bit] NOT NULL,
    [Name] [nvarchar](40) NOT NULL,
    [Surname] [nvarchar](40) NOT NULL,
    [Login] [nvarchar](40) NOT NULL,
    [Password] [nvarchar](14) NOT NULL,
    [Email] [nvarchar](50),
    [Phone] [nvarchar](max) NOT NULL,
    [Address] [nvarchar](50),
    [BirthDate] [datetime] NOT NULL,
    CONSTRAINT [PK_dbo.Users] PRIMARY KEY ([ID])
)
CREATE UNIQUE INDEX [IX_Login] ON [dbo].[Users]([Login])
CREATE UNIQUE INDEX [IX_Email] ON [dbo].[Users]([Email])
ALTER TABLE [dbo].[Accounts] ADD CONSTRAINT [FK_dbo.Accounts_dbo.Currencies_Currency_ID] FOREIGN KEY ([Currency_ID]) REFERENCES [dbo].[Currencies] ([ID]) ON DELETE CASCADE
ALTER TABLE [dbo].[Accounts] ADD CONSTRAINT [FK_dbo.Accounts_dbo.Users_User_ID] FOREIGN KEY ([User_ID]) REFERENCES [dbo].[Users] ([ID]) ON DELETE CASCADE
ALTER TABLE [dbo].[Transactions] ADD CONSTRAINT [FK_dbo.Transactions_dbo.CurrencyForDates_CurrencyForDate_ID] FOREIGN KEY ([CurrencyForDate_ID]) REFERENCES [dbo].[CurrencyForDates] ([ID]) ON DELETE CASCADE
ALTER TABLE [dbo].[Transactions] ADD CONSTRAINT [FK_dbo.Transactions_dbo.Accounts_FromUserAccount_ID] FOREIGN KEY ([FromUserAccount_ID]) REFERENCES [dbo].[Accounts] ([ID]) ON DELETE CASCADE
ALTER TABLE [dbo].[Transactions] ADD CONSTRAINT [FK_dbo.Transactions_dbo.Accounts_ToUserAccount_ID] FOREIGN KEY ([ToUserAccount_ID]) REFERENCES [dbo].[Accounts] ([ID])
ALTER TABLE [dbo].[Transactions] ADD CONSTRAINT [FK_dbo.Transactions_dbo.Accounts_Account_ID] FOREIGN KEY ([Account_ID]) REFERENCES [dbo].[Accounts] ([ID])
ALTER TABLE [dbo].[CurrencyForDates] ADD CONSTRAINT [FK_dbo.CurrencyForDates_dbo.Currencies_Currency_ID] FOREIGN KEY ([Currency_ID]) REFERENCES [dbo].[Currencies] ([ID]) ON DELETE NO ACTION
CREATE TABLE [dbo].[__MigrationHistory] (
    [MigrationId] [nvarchar](150) NOT NULL,
    [ContextKey] [nvarchar](300) NOT NULL,
    [Model] [varbinary](max) NOT NULL,
    [ProductVersion] [nvarchar](32) NOT NULL,
    CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId], [ContextKey])
)
INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
VALUES (N'201701191842575_InitialCreate', N'DatabaseLibrary.Migrations.Configuration',  0x1F8B0800000000000400ED1DD96EE4B8F13D40FE41D0531278DD6D7B06488CF62E3CF63830323E30EDD9E46D404B745B888E5E8AF2BA11E4CBF2B09FB4BF10EAA2788B94BADB6DC39897364516EB62B1C82AD6FCFEBFDF663F3D27B1F704511E65E9897FB03FF53D98065918A58B13BFC00F3FFCD5FFE9C73FFE61F6394C9EBD9FDB7E47653F3232CD4FFC478C97C793491E3CC204E4FB4914A02CCF1EF07E902513106693C3E9F46F9383830924207C02CBF3665F8B144709ACFE207F9E65690097B800F15516C2386FDAC9977905D5BB0609CC97208027FE39C0E01EE4F04B748F005AED93B1183E63DF3B8D2340D099C3F8C1F7409A66186082ECF1B71CCE31CAD2C57C491A407CB75A42D2EF01C4396C8838EEBADBD2333D2CE99974035B504191E32C71047870D43068220E1FC4669F3290B0F03361355E9554576C3CF14F832023FCF73D71AEE3B31895FD6426977FD7A2D96F46EF79429F3DAA1D4489CA7F7BDE5911E302C1931416188178CFBB2DEEE328F8075CDD65FF86E9495AC4318B2A41967CE31A48D32DCA9610E1D557F8D0107079EE7B137EDC441C488731636ADA2E537C74E87BD76472701F43AA090C1FE63843F0EF3085086018DE028C212282BC0C61C54B697661AE5BC2882C05F17591DC43D4CE4B94902C2ADFBB02CF5F60BAC08F64B9113C2EA26718B60D0D2ADFD2882C413206A3022A50354FFF09C480ACA776DEF38C70DD02CA35788A1615FD02BCB30221621308D95F615C75C81FA365BDD25A75F8DE75BA4059F2358B3B45A3DFBECFB3025588659A0E77002D20B647ED0E813407418593113DBEA38C22FB5D8B26D7C9155562869011C5BA838C5AD9AE45A9FAA8426536E9D6BDD11A74821B640EDAE1EFF6403FD7FC3143B8FC693005479BB00417A47BCFBC871FC74F6CAD6BCC021AA86E0C84778DD3CFC5B0A99C92CABFB437D23747A562C6130174DB0CF97D1725EEF0E6459200D7CD4ADCA2B22481A54BA3DF6AA7D3A995A6BBEE8A1719AAD9A030ED0CABBE4BFD3B4B6FE826197E535FD72DA9C4A0DC40A843D84382D45F4D82D0CD4882D8D7D901C85C08107AABD1E73A1991E77BAE6517A6DA316A336EA0BC5B48FD5C9DB91A69BEAE0803A3651C758EFE661D6E71D1AB1C6F5D1F499BB51D472973EDC90ED2E072E8BBDA1AE6CA4FC3244ADB093F65448C207556DA1EA7F083DD56E9BCD1A3F425E6FD922D3A8E6D6DD65B90E7BF662834F9241F3631F1E70444B161D68F83FC2091BAC72C354992FCDC046DA76188609E6F9ABA4F11C28FC39C5BAD516FDC04F33585F10EA0B5C9CA3B80D6B2DB19EC22519FCAEA03C1657E11834577473AF6A456F65D9B5127920C218A5744F0ACD1E5A57005CB9B37BA1257F5E1E0671017E4EFA92434AE7B85F8432987A6FF81B93FD93CA212AFA6F7A1B9F73F23FC1822F02BED7F24CBAC960EDB789AE7591055CCE7D5A9DBFEF9393FA7A1D77709D71D09A947DC3A3301D19A13FF2F122906B0543B3BB09D6BC2C33DF0C58DF8263D8731C4D03B0DEA3BF333900720949717E14EC8718BE18C99615ABF494761BF1325534ADD777B46F6BA60BBCA50D3E15647ACD549577955E1C2529B33B2BDF05E9CB9E2B1DB866CED197CADCCD59DDEFB4DCB8B3395BF0AB02156732FB05686AA6F14FAD939DDDF3F10F7116BB62863247D765F1D301980683F74051BEC593D800F9513D687211F9559CB56CA3B791DC8DA29DCFAFAA97DC732BC0EA294FA2FF35B1A7097DC428268E319E68D9F2D925C429C432CB9C49D9F2AB251E21A0FA2B1DD115401E9B6CB1E287C745082C3699B1D42ED6662428BEE373D204BF9ABE0D47A210C668429319AB92B62BAE902B9A28259B894147356B6130740ADF6338058098B9ACC136BC108FDE599CC103B87D1CD6594E96214C5C0A85E2771530C334630649E59FB84CE5E214320BF5A0D5CB3F1031D2432927D52F4C4CC3EA3D7E7ECF78D659FCED3B358F123D926C46CCC4C3378758E7EDD5886A93DB9CDB04B9DE4A237F17A47CFDED51B6AEA959E9D25B347B0A6DE2BF52C917DBE7EAF6F280B383F8F01D2ECF3D634B7D77BD445A3DF66933A6FB269984D340996B32BB05C46E98249B86C5ABC799D6D79F6C3DC3D0331A9614C825C918848B1A533E10C810514BE9631FD105E4428C7EDC5A1EF9D8589D4AD7348355E543B8FE073CA726ADDAB7640F99B060B5539A7FB1A43D3B1F1825056DE3D5644425961E4915E99F30A62801441A6B32C2E925417A8328D1633125948E2377BA834D19005471B6538B389C0165106134908D2D18517AA95C81987681D42D7F9811652D70FDD8CD899C4331608D36C0FABCB25634175AD3B23EE9EDDCD5DE0ECF1CF5DE6C6D19B11BB14D06141491F07C1AD0F001AB8AA53AD096E9301C6A968DD640F836680B15068E3CE28A774C658A745D29CB41C0C9316C26614B50BABB230BA567B486C160E0B8B6DDF1925A81DBD75485EE5B65A885B3D6C3332A6192B1C88B6D11E8EBCF7B8EE6034FF8437344DA33D9C269F8485D234393864343B8473C568AB3DA426DD8305D334396053677370A8D44DF630686A060B85363A38955DEE05E75676CDDB5FC7FC114C79A060AE12ADCF0DCC18CBF341799A54E7954857823293AC163705A35AE555ECA0053000B5E6E43C1035378CC483B3B360F577C5CE3BB241D016B7A4E6C4F35D147CDF3DF8EB5000E3DDB7D3B1411EEE704A50F0D7E2627BA416B4D0D6A00C16B7FBAF4F1FA4CB7C377D9086AF4F1F3437F503592C425BB33E68C215AF4F1F8428859B360883D7A70BCA20C440E6F2B0D6AC07CA18CC56B4C0ABAA0F84519507729997E9BD34EFD585FCD1DAA40EE2D8FB92FCB8713A648AFC0C94CA1A15C7144ADA299DD982B6D4712D7B2DA9FB8F3F6DB031AC813CAF40AC511DD8D8DC8E6C2052844EEC420FAE34522744E4664D74ACBF2E8A142EABBBF81EC1FD290AAB50D92AC730A992F4F7E7BFC46771545D8EB61DAE401A3DC01CD7C9F6FEE1B42C4FC15555D99D0A27933C0FB9075EFA3227BCCCB6F00A2CA29BB8E99D97EB7322654D91F409A0E011A85EDB5DA6217C3EF1FF430CD4B734FAA580C7DE1D2AA0F75FA902C9B8F2220F7106B0FB836DF6B4C9B04D4F4639EED8BBFCD77766E89E778388E21E7BD3922C4714A8FD719BBE19E630B57B298EB7A1B252D98BD1DA7A34BA02C66814CA7A19EB2F86F13604AEA93A51CDB59E221321F98D4717991868B2F81A139D264955263AC0368F0D55572EC32C6207619461549DF9DD1092218C42483E7BB9A1238ED7216323ADE1580C997F70FD88B76150C4220D8397BF5CA4E195B82D6E3517DE86D4851A07F791BB9CD45BBEF0E67F5CF9827581E5AA138C764F062020162A506F6C1FC6D521184DD847E77D952B51D0CEFFA7043CFF796CD9012587DC1194AA0C589A379D4D18F1489C8F6D6EEDB5B1A7488F1EF69A8E1834884A7B03E2B32CCD3102919C05708BA23488962016A996AF8B6C0C65490F05297E39874B98961650A0CE66AA9E502C052DF0B68F07DB782CFF920AA48CD10E7DA0BFF30AD59FF4B78B8A35A468C008B96E48D3B807A1435F808FD23017A98F543473FAB35EC9CC29045BD635DB1A0A0E9BD09BD32D972D6ACB3A659786B0659DB22B21E1A0513DC511DE3543319D4D5AC216F462480D8D7795D88C4AEC8C32180B897491FBAD94F978E1A396E6A1C28B1EB30C09086B5712753115F989AB283165C11453BD943AEA7FE287F719116F7D87A07D6AAE2B5E62ACA5A29AC15073C2506BA5AFD48A6A26E3FBF09E622C36B5580CD4E90B43A82AB6680BB6A866503FFDDE462D1751E4FC3B558BE7ECAA77F0AFA7528B3BD91A9D5226F3BF92FA2B2348D27B239AE4C3575253C541B95F98051BA98FB2DBE46FB6DEC98E133DB29209BB35756F41376FE71D8A95C8298FC4F122B3B5FF611C71FAF268D1812893715318702E17ED73993E64ADEB2760D4761163C5108390F863A708470F447CE47300F3BC2A34DDD4ECFD9CDCC3F032BD29F0B2C0846498DCC7DCAE517A90A6F9AB8A2C3CCEB39B65A5A0EB2081A01995C1A49BF45311C521C5FB42114CD280285DD326A65BCA1297B1DDC58A42BA965E87EA0035ECA31EF51D4C9671E945DDA473F00487E04654F60B5C8060D566AEEA81F40B8267FBEC3C020B0492BC81D18D277F121D0E93E71FFF0F2012C47337710000 , N'6.1.3-40302')

